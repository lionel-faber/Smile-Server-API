<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Authorize</title>


  <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  {% load static %}
  <link rel="stylesheet" href="{% static 'serverweb/css/authorize.css' %}">
  <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyD1xt1vW7bslVd4WABHYdsxmt_cnqDWGB0",
      authDomain: "smile-aff5a.firebaseapp.com",
      databaseURL: "https://smile-aff5a.firebaseio.com",
      projectId: "smile-aff5a",
      storageBucket: "smile-aff5a.appspot.com",
      messagingSenderId: "1056667244830"
    };
    firebase.initializeApp(config);
  </script>
  <script type="text/javascript">
    initApp = function() {
      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
          // User is signed in.
          var email = user.email;
          var name = user.displayName;
          document.getElementById('email').value = email;
          document.getElementById('name').value = name;
          var URL = "{% url 'isauthorized' %}";
          var data = {'email': email};
          $.post(URL, data, function(response){
            if(response === 'success'){ window.location.replace('home') }
          });

        } else {
          // User is signed out.
          window.location.replace('login');

        }
      }, function(error) {
        console.log(error);
      });
    };

    window.addEventListener('load', function() {
      initApp()
    });
  </script>
  <script>
  function setVal4()
  {
    document.getElementById('semester').value = "4"
  }
  function setVal6()
  {
    document.getElementById('semester').value = "6"
  }
  </script>

</head>

<body>
  <div class="container demo">


    <div class="text-center">
      <h2>{{ message }}</h2>
      <button type="button" class="btn btn-demo" data-toggle="modal" data-target="#Modal" onclick="setVal4()">
			Semester 4
		</button>

      <button type="button" class="btn btn-demo" data-toggle="modal" data-target="#Modal" onclick="setVal6()">
			Semester 6
		</button>
    </div>

    <div class="modal fade" id="Modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title" id="myModalLabel">Whats the magic word?</h4><br>
          </div>

          <div class="modal-body">


            <form action="{% url 'validate' %}" method="post">
              {% csrf_token %}

              <input type="text" name="semester" id="semester" style="display: none"/>
              <input type="text" name="name" id="name" style="display: none"/>
              <input type="text" name="email" id="email" style="display: none"/>
              <div class="group">
                <input type="text" required name="password">
                <span class="highlight"></span>
                <span class="bar"></span>
                <label>Password</label>
              </div>


          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-dialog" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-dialog">Let's go</button>
          </div>
        </form>
        </div>
        <!-- modal-content -->
      </div>
      <!-- modal-dialog -->
    </div>
    <!-- modal -->


  </div>
  <!-- container -->

  <footer class="demo-footer">
    <a href="http://www.bootpen.com" target="_blank">Simple Mobile Instant Learning Environment</a>
  </footer>
  <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
  <script src='http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js'></script>


</body>

</html>
